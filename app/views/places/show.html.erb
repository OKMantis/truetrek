<h1>Details page: <%= @place.title %></h1>
<div class="">
  <strong>Wiki description: </strong><%= @place.wiki_description %>
</div>
<div class="">
  <strong>City: </strong><%= @place.city.name %>
</div>
<div class="mt-3">
  <% if user_signed_in? %>
    <% travel_book = current_user.travel_book %>
    <% if travel_book && travel_book.places.include?(@place) %>
      <% travel_book_place = travel_book.travel_book_places.find_by(place: @place) %>
      <%= button_to "Remove from Travel Book", travel_book_place_path(travel_book_place), method: :delete, class: "btn btn-outline-danger" %>
    <% else %>
      <%= button_to "Add to Travel Book", place_travel_book_places_path(@place), method: :post, class: "btn btn-primary" %>
    <% end %>
  <% end %>
</div>
<div class="container" style="display:flex;flex-direction:column;">
  <div class="d-flex gap-3">
    <div>
      <h2>Images</h2>
      <div class="place-images" style="display: flex; flex-wrap: wrap; gap: 10px;">
        <% @place.comments.each do |comment| %>
          <% comment.photos.each do |photo| %>
            <%= cl_image_tag photo.key, height: 300, width: 400, crop: :fill %>
          <% end %>
        <% end %>
      </div>
    </div>
    <div data-controller="map"
  id="map"
  data-map-api-key-value="<%= ENV['MAPBOX_API_KEY'] %>"
  data-map-markers-value="<%= @markers.to_json %>"
  style= 'width: 100%; height: 300px;'>
    </div>
  </div>
  <h2>Comments</h2>
  <% @place.comments.each do |comment| %>
    <div class="comment" style="margin-bottom: 20px; padding: 10px; border: 1px solid #ccc;">
      <div>
        <strong>User: </strong><%= comment.user.email %>
      </div>
      <div>
        <strong>Comment: </strong><%= comment.description %>
      </div>
    </div>
  <% end %>
  <h2>Add a Comment</h2>
  <%= simple_form_for @comment, url: city_place_comments_path(@place.city, @place) do |f| %>
    <%= f.input :description, label: "Write your description of the place you visited." %>
    <%= f.input :photos, as: :file, input_html: { multiple: true }, direct_upload: true, label: "Upload your photos." %>
    <%= f.submit "Add Comment" %>
  <% end %>
</div>
