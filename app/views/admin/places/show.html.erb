<div class="admin-page">
  <div class="admin-header">
    <h1><i class="fa-solid fa-map-pin"></i> <%= @place.title %></h1>
    <%= link_to admin_places_path, class: "back-link" do %>
      <i class="fa-solid fa-arrow-left"></i> Back to Places
    <% end %>
  </div>

  <div class="place-detail-card">
    <div class="place-info">
      <p class="place-city"><i class="fa-solid fa-location-dot"></i> <%= @place.city.name %></p>
      <% if @place.address.present? %>
        <p class="place-address"><%= @place.address %></p>
      <% end %>
      <% if @place.enhanced_description.present? %>
        <div class="place-description">
          <h3>Description</h3>
          <p><%= @place.enhanced_description %></p>
        </div>
      <% end %>
    </div>

    <div class="place-stats">
      <div class="stat">
        <span class="stat-number"><%= @place.comments.count %></span>
        <span class="stat-label">Comments</span>
      </div>
      <div class="stat">
        <span class="stat-number <%= 'warning' if @reports.pending.any? %>"><%= @reports.count %></span>
        <span class="stat-label">Reports</span>
      </div>
    </div>

    <div class="place-actions">
      <%= link_to city_place_path(@place.city, @place), class: "btn-view", target: "_blank" do %>
        <i class="fa-solid fa-external-link"></i> View Public Page
      <% end %>
      <%= button_to admin_place_path(@place), method: :delete, class: "btn-delete", data: { turbo_confirm: "Are you sure you want to delete this place? This action cannot be undone." } do %>
        <i class="fa-solid fa-trash"></i> Delete Place
      <% end %>
    </div>
  </div>

  <!-- Reports Section -->
  <% if @reports.any? %>
    <div class="admin-section">
      <h2>Reports (<%= @reports.count %>)</h2>
      <div class="reports-table">
        <table>
          <thead>
            <tr>
              <th>Reported By</th>
              <th>Reason</th>
              <th>Status</th>
              <th>Date</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <% @reports.each do |report| %>
              <tr>
                <td>
                  <%= report.user.username %>
                  <% if report.user.city&.downcase == @place.city.name&.downcase %>
                    <span class="local-tag">Local</span>
                  <% end %>
                </td>
                <td><%= report.reason %></td>
                <td><span class="status-badge <%= report.status %>"><%= report.status.humanize %></span></td>
                <td><%= time_ago_in_words(report.created_at) %> ago</td>
                <td>
                  <%= link_to "Review", admin_report_path(report), class: "btn-review" %>
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>
    </div>
  <% else %>
    <div class="admin-section">
      <h2>Reports</h2>
      <div class="empty-state">
        <i class="fa-regular fa-check-circle"></i>
        <p>No reports for this place.</p>
      </div>
    </div>
  <% end %>
</div>
